@model WantSoraCoreMVC.ViewModels.ForumPostViewModel
@using System.Web;
@{
    ViewData["Title"] = "PostView";
    int categoryId = Model.MainPost.ForumPostCategories.FirstOrDefault().CategoryId;
    string categoryTitle = Model.MainPost.ForumPostCategories.FirstOrDefault().Category.Title;
}


<nav class="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/Forum">討論區</a></li>
        <li class="breadcrumb-item">@Html.ActionLink(@categoryTitle, "PostList", "Forum", new { categoryId = categoryId }, null)</li>
        <li class="breadcrumb-item active">@Model.MainPost.Title</ li >

    </ol>
</nav>


@*#1的部分*@
<div class="bg-primary bg-opacity-10 rounded-3">　
    <div class="bg-body rounded-3 border mx-3 p-3">
        <h4 class="border-bottom"><i class="bi bi-chat-right-heart-fill text-danger text-opacity-50"></i> @Model.MainPost.Title</h4>
    <div class="p-3">
        <div class="border-bottom row">
            <span class="col-8">作者：@Model.MainPost.Account.UserName</span>
                <span class="col-4 text-end">　
                <span class="small text-body-tertiary">@Model.MainPost.Created</span>　
                <span class="small small text-body-tertiary">觀看次數: @Html.DisplayFor(model => model.MainPost.ViewCount)</span>　
                <span class="badge rounded-pill bg-primary bg-opacity-25 bi bi-star-fill text-danger text-opacity-75">Like</span>
            </span>
        </div>
        <div class="col-11 m-auto pt-3">
            @Html.Raw(HttpUtility.HtmlDecode(Model.MainPost.PostContent))

        </div>
    </div>
        @{
            if (Model.MainPost.Updated != null)
        {
            <div class="small text-body text-opacity-50 text-end">最後更新時間：@Model.MainPost.Updated</div>
        }
    }
    <hr />
        <div class="bg-info">
            @{
                foreach (var comment in Model.Comments)
                {
                    <div>@comment.Comment</div>
                }
            }
        </div>
</div>　
</div>

@*#2之後的部分*@
@{
    foreach(var item in Model.Replies)
    {
        <br />
<div class="bg-primary bg-opacity-10 rounded-3">　
    <div class="bg-body rounded-3 border mx-3 p-3">
        <div class="p-3">
            <div class="border-bottom row">
                <span class="col-8">作者：@item.Account.UserName</span>
                <span class="col-4 text-end">
                    <span class="small text-body-tertiary">@item.Created</span>　
                    <span class="badge rounded-pill bg-primary bg-opacity-25 bi bi-star-fill text-danger text-opacity-75">Like</span>
                </span>
            </div>
            <div class="col-11 m-auto pt-3">
                @Html.Raw(HttpUtility.HtmlDecode(item.PostContent))

            </div>
        </div>
        @{
            if (item.Updated != null)
            {
                        <div class="small text-body text-opacity-50 text-end">最後更新時間：@item.Updated</div>
                    }
                }
                <hr />

    </div>　
</div>
    }
}

<p>
    @Html.ActionLink("回上一頁", "PostList", "Forum", new { categoryId = categoryId }, null)
</p>

<script src="~/Scripts/tinymce/tinymce.min.js"></script>

<script>
    tinymce.init({
        selector: 'textarea#tiny',
        menubar: false,
        plugins: [
            'a11ychecker', 'advlist', 'advcode', 'advtable', 'autolink', 'checklist', 'export',
            'lists', 'link', 'image', 'charmap', 'preview', 'anchor', 'searchreplace', 'visualblocks',
            'powerpaste', 'fullscreen', 'formatpainter', 'insertdatetime', 'media', 'table', 'help', 'wordcount'
        ],
        toolbar: 'undo redo | a11ycheck casechange blocks | bold italic forecolor backcolor | alignleft aligncenter alignright alignjustify |' +
            'bullist numlist checklist outdent indent | removeformat | code table help'
    })
</script>